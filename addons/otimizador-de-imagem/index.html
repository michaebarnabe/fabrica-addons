<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Otimizador Pro: Social & Web</title>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; margin: 0; background-color: #f8f9fa; color: #333; }
        .container { max-width: 950px; margin: 2rem auto; padding: 2rem; background-color: #fff; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
        h1 { color: #212529; margin-bottom: 0.5rem; }
        p.subtitle { color: #6c757d; margin-top: 0; margin-bottom: 2rem; }
        
        .panel { background-color: #f1f3f5; padding: 1.5rem; border-radius: 6px; margin-bottom: 1.5rem; }
        
        /* ConfiguraÃ§Ãµes */
        .settings-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; }
        .form-group label { display: block; margin-bottom: 0.8rem; font-weight: 600; }
        
        .radio-group { display: flex; flex-direction: column; gap: 0.8rem; }
        .radio-option { display: flex; align-items: center; cursor: pointer; padding: 8px; border-radius: 4px; transition: background 0.2s; border: 1px solid transparent; }
        .radio-option:hover { background: #e9ecef; border-color: #dee2e6; }
        .radio-option input { margin-right: 12px; transform: scale(1.3); }
        
        .badge { font-size: 0.75rem; padding: 4px 8px; border-radius: 4px; margin-left: 10px; font-weight: 700; text-transform: uppercase; letter-spacing: 0.5px; }
        .badge-social { background-color: #d63384; color: white; } /* Instagram Pink */
        .badge-web { background-color: #0d6efd; color: white; } /* Tech Blue */
        
        /* Slider */
        .range-container { display: flex; align-items: center; gap: 1rem; margin-top: 0.5rem; }
        input[type="range"] { flex-grow: 1; cursor: pointer; height: 6px; background: #dee2e6; border-radius: 5px; appearance: none; }
        input[type="range"]::-webkit-slider-thumb { appearance: none; width: 20px; height: 20px; background: #0d6efd; border-radius: 50%; cursor: pointer; border: 2px solid #fff; box-shadow: 0 1px 3px rgba(0,0,0,0.3); }
        #qualityValue { font-weight: bold; min-width: 3.5rem; text-align: right; color: #0d6efd; font-size: 1.1rem; }

        /* BotÃµes */
        .selection-box { border: 2px dashed #adb5bd; padding: 1.5rem; text-align: center; border-radius: 6px; background-color: #fff; margin-top: 1rem; }
        .btn-select { width: 100%; max-width: 300px; padding: 0.8rem; margin: 0.5rem 0; font-size: 1rem; font-weight: bold; cursor: pointer; border: 1px solid #0d6efd; background-color: #fff; color: #0d6efd; border-radius: 6px; transition: all 0.2s; }
        .btn-select:hover { background-color: #0d6efd; color: #fff; }
        .text-link { color: #0d6efd; cursor: pointer; text-decoration: underline; border: none; background: none; font-size: 0.95rem; }

        .actions { text-align: right; margin-top: 1rem; display: flex; justify-content: space-between; align-items: center; }
        .btn { padding: .75rem 1.5rem; font-size: 1rem; font-weight: bold; border-radius: 6px; border: none; cursor: pointer; transition: background-color 0.2s; color: #fff; }
        .btn-primary { background-color: #0d6efd; }
        .btn-primary:disabled { background-color: #6c757d; cursor: not-allowed; }
        .btn-success { background-color: #198754; display: none; }
        
        .btn-sm { padding: 0.4rem 0.8rem; font-size: 0.85rem; background-color: #198754; color: white; text-decoration: none; border-radius: 4px; display: inline-block; cursor: pointer; border: none; }
        .btn-sm:hover { background-color: #157347; }
        .btn-sm.disabled { background-color: #ccc; pointer-events: none; }

        /* Tabela */
        table { border-collapse: collapse; width: 100%; margin-top: 1.5rem; font-size: 0.9rem; }
        th, td { border: 1px solid #dee2e6; padding: .75rem; text-align: left; vertical-align: middle; }
        th { background-color: #f8f9fa; }
        .thumb-img { max-width: 60px; max-height: 60px; border-radius: 4px; object-fit: cover; }
        
        .good { color: #0f5132; font-weight: bold; background-color: #d1e7dd; padding: 2px 6px; border-radius: 4px; }
        .bad { color: #842029; font-weight: bold; background-color: #f8d7da; padding: 2px 6px; border-radius: 4px; }
        
        .info-box { font-size: 0.85rem; color: #055160; background-color: #cff4fc; border: 1px solid #b6effb; padding: 12px; border-radius: 6px; margin-top: 15px; display: none; line-height: 1.5; }
    </style>
</head>
<body>

    <div class="container">
        <h1>Otimizador Pro: Social & Web</h1>
        <p class="subtitle">A ferramenta definitiva para Designers e Social Media Managers.</p>

        <div class="panel">
            <div class="settings-grid">
                <div class="form-group">
                    <label>Escolha o Objetivo:</label>
                    <div class="radio-group">
                        <label class="radio-option">
                            <input type="radio" name="format" value="image/webp" checked onchange="updatePreset()"> 
                            WEBP <span class="badge badge-web">Para Sites & Performance</span>
                        </label>

                        <label class="radio-option">
                            <input type="radio" name="format" value="image/jpeg" onchange="updatePreset()"> 
                            JPG <span class="badge badge-social">Para Instagram / LinkedIn</span>
                        </label>
                    </div>
                    
                    <div id="jpgInfo" class="info-box">
                        ðŸ“± <strong>Modo Social Media:</strong> Qualidade ajustada para <strong>90%</strong>. <br>
                        âœ¨ Fundos transparentes (PNG/WebP) serÃ£o automaticamente preenchidos com <strong>Branco</strong> para evitar que fiquem pretos nas redes sociais.
                    </div>
                    <div id="webInfo" class="info-box" style="display: block;">
                        ðŸš€ <strong>Modo Web Performance:</strong> Qualidade ajustada para <strong>75%</strong>. <br>
                        âœ¨ A transparÃªncia das imagens Ã© preservada. Perfeito para Google PageSpeed e lojas virtuais.
                    </div>
                </div>

                <div class="form-group">
                    <label>Ajuste Fino de Qualidade: <span id="qualityValue">75%</span></label>
                    <div class="range-container">
                        <span>Menor Arquivo</span>
                        <input type="range" id="qualitySlider" min="0.1" max="1.0" step="0.05" value="0.75">
                        <span>Melhor Visual</span>
                    </div>
                    <small style="color: #666; display: block; margin-top: 8px;">
                        O slider se ajusta automaticamente ao formato escolhido, mas vocÃª pode personalizÃ¡-lo.
                    </small>
                </div>
            </div>
        </div>

        <div class="panel" id="selectionPanel">
            <div class="selection-box">
                <button id="selectFolderBtn" class="btn-select">ðŸ“‚ Selecionar Pasta</button>
                <br>
                <button id="selectFilesBtn" class="text-link">Ou selecione arquivos soltos</button>
            </div>
            <input type="file" id="fileInput" multiple accept=".jpg,.jpeg,.png,.heic,.webp" style="display: none;">
        </div>

        <div class="actions">
            <div id="status" style="font-weight: 500;">
                <span id="statusText">Aguardando arquivos...</span>
                <progress id="progressBar" value="0" max="100" style="display:none; width: 100%; height: 8px; margin-top: 5px;"></progress>
            </div>
            <div>
                <button id="processBtn" class="btn btn-primary" disabled>Processar Imagens</button>
                <button id="downloadBtn" class="btn btn-success">Baixar Tudo (ZIP)</button>
            </div>
        </div>
        
        <div class="results">
            <table>
                <thead>
                    <tr>
                        <th>Preview</th>
                        <th>Arquivo</th>
                        <th>Status</th>
                        <th>Tam. Original</th>
                        <th>Tam. Final</th>
                        <th>ReduÃ§Ã£o</th>
                        <th style="width: 100px; text-align: center;">Download</th>
                    </tr>
                </thead>
                <tbody id="resultsBody">
                </tbody>
            </table>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/jszip@3.10.1/dist/jszip.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/heic2any@0.0.4/dist/heic2any.min.js"></script>
    
    <script type="module" src="index.js"></script>

    <script>
        // LÃ³gica de Presets Inteligentes
        function updatePreset() {
            const format = document.querySelector('input[name="format"]:checked').value;
            const slider = document.getElementById('qualitySlider');
            const qualityDisplay = document.getElementById('qualityValue');
            const webInfo = document.getElementById('webInfo');
            const jpgInfo = document.getElementById('jpgInfo');
            
            if (format === 'image/jpeg') {
                // Preset Social Media: Alta qualidade
                slider.value = 0.9;
                qualityDisplay.textContent = "90%";
                jpgInfo.style.display = 'block';
                webInfo.style.display = 'none';
            } else if (format === 'image/webp') {
                // Preset WebP: EquilÃ­brio
                slider.value = 0.75;
                qualityDisplay.textContent = "75%";
                jpgInfo.style.display = 'none';
                webInfo.style.display = 'block';
            }
        }
    </script>
</body>
</html>